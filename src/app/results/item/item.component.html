<div class="__inside" *ngIf="item">

  <!-- TYPE -->
  <div class="row --header">
    <strong>Blueprint</strong>

    <div class="__rarity --{{ item.rarity }}">
      {{ item.rarity }}
    </div>
  </div>

  <!-- NAME -->
  <div class="row --name">
    <div class="icon--items icon--items--{{ item.icon }}"></div>
    <div class="__name --{{ item.rarity }}">
      {{ item.name }}
    </div>
  </div>

  <!-- EFFECTS -->
  <div class="row --effects">
    <ul>
      <li *ngFor="let effect of item.effects || []" [class.--positive]="effect.beneficial"
        [class.--negative]="!effect.beneficial">
        <span>{{ effect.name }}<ng-container *ngIf="effect.scaling">:</ng-container></span>
        <span class="__value --left" *ngIf="effect.scaling">
          {{ effect | effectValue:level:1 }}
        </span>
        <span class="__value --right" *ngIf="effect.scaling && item.effectsRange">
          {{
          (effect | effectValue:level:0.95).slice(0, -1) +
          ' — ' +
          (effect | effectValue:level:1.05).slice(1)
          }}
          <div class="tooltip">Effect Range (+/- 5%)</div>
        </span>
      </li>
    </ul>
  </div>

  <!-- CURRENT LEVEL -->
  <div class="row --level">
    <div>
      Required&nbsp;Level:&nbsp;&nbsp;{{ level }}
    </div>
  </div>

  <!-- LEVELS -->
  <div class="row --levels">
    <div>
      Available&nbsp;at&nbsp;levels:&nbsp;&nbsp;
    </div>

    <ng-container *ngIf="item.levels.length > 1">
      <ng-container *ngFor="let level of item.levels">

        <div class="__level">
          <button type="button" (click)="setLevel(level)">
            {{ level }}
            <div class="tooltip">{{ level }}</div>
          </button>
        </div>

      </ng-container>
    </ng-container>

    <ng-container *ngIf="item.levels.length <= 1">
      <div class="__level">
        {{ item.levels[0] || '?' }}
      </div>
    </ng-container>
  </div>

  <!-- RECIPE -->
  <div class="__recipe" *ngIf="item.recipe">
    <div class="row --recipe">
      <span>Craftable at</span>
      <span>&nbsp;<strong>{{ item.recipe.school }}&nbsp;School</strong></span>
      <span *ngIf="item.recipe.level !== level">&nbsp;&nbsp;—&nbsp;&nbsp;Level
        {{ item.recipe.level }}</span>:
    </div>
    <div class="row --materials">
      <ng-container *ngFor="let ref of item.recipe.materials">
        <ng-container *ngIf="materials[ref.id] as mat">
          <span class="__mat-amount">{{ ref.quantity }}</span>
          <span class="icon--materials icon--materials--{{ mat.icon }}"></span>
          <span class="__mat-text --{{ mat.rarity }}">{{ mat.name }}</span>
        </ng-container>
      </ng-container>
    </div>
  </div>

  <!-- VENDOR -->
  <div class="__vendors" *ngFor="let vendor of item.vendors">
    <div class="row --vendor">
      <span>Purchasable at</span>
      <span>&nbsp;<strong>{{ vendor.name }}</strong></span>
      <span *ngIf="vendor.rotation">&nbsp;({{ vendor.rotation }} Legendary Rotation)</span>:
    </div>

    <div class="row --materials">
      <div class="icon--materials icon--materials--{{ vendor.currency.toLowerCase() }}"></div>
      <div class="__mat-text">
        <span>{{ vendor.price }}</span>
        <span *ngIf="vendor.level !== level || item.levels.length > 1">
          &nbsp;&nbsp;—&nbsp;&nbsp;Level {{ vendor.level }}
        </span>
      </div>
    </div>
  </div>

</div>
